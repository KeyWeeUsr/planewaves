<WavevectorMaker>:
    canvas:
        Color:
            rgba: 0, 0, 0, 0.7 if self.axes else 0
        Line:
            width: 2
            points: [self.x+0.5*self.width, self.y, self.x+0.5*self.width, self.y+self.height]
        Line:
            width: 2
            points: [self.x, self.y+0.5*self.height, self.x+self.width, self.y+0.5*self.height]

<PlaneWaveShader>:
    canvas:
        Color:
            rgb: 1, 0, 0
        Rectangle:
            pos: self.pos
            size: self.size
    on_shader_mid: self.replace_shader()
    on_shader_bottom: self.replace_shader()

<AppLayout>:
    orientation: 'vertical'
    wavevector_layout: wv_layout
    Widget:
        id: container
        PlaneWaveShader:
            id: shader
            pos: container.pos
            size: container.size
        WavevectorMaker:
            id: wv_layout
            pos: container.pos
            size: container.size
            shader_widget: shader
    BoxLayout:
        size_hint_y: None
        height: sp(40)
        orientation: 'horizontal'
        Button:
            text: 'intensity'
            on_press: shader.mode = 'intensity'
        Button:
            text: 'phase'
            on_press: shader.mode = 'phase'
        Button:
            text: 'both'
            on_press: shader.mode = 'both'
        Button:
            text: 'toggle\n axes'
            on_press: wv_layout.toggle_axes()
        Button:
            text: 'reset'
            on_press: wv_layout.reset()

<WvMarker>:
    size: sp(40), sp(40)
    size_hint: None, None
    opacity: 0.3
    canvas:
        Color:
            rgba: 0, 0, 0, 1
        Ellipse:
            pos: self.pos
            size: self.size
        Color:
            rgb: self.colour
        Ellipse:
            pos: self.x+0.1*self.width, self.y+0.1*self.height
            size: 0.8*self.width, 0.8*self.height